{% extends "base_forum.html" %}{% load forum_tags %}
{% block extrahead %}{% if is_paginated %}<script type="text/javascript" src="{{ MEDIA_URL }}js/Paginator.js"></script>{% endif %}{% endblock %}
{% block main_content %}
{% if forum.description %}<p class="description">{{ forum.description|escape }}</p>{% endif %}
<div class="tools">
{% if is_paginated %}<div class="paginator">{% paginator "Topic" %}</div>{% endif %}
{% if user.is_authenticated %}
<div class="topic-actions">
  <a href="{% url forum_add_topic forum.id %}">New Topic</a>
</div>
{% endif %}
</div>
<div class="module no-margin">
<h2>{{ forum.name|escape }}</h2>
<table>
<thead>
  <tr>
    <th>Topic</th>
    <th>Started By</th>
    <th>Posts</th>
    <th>Views</th>
    <th>Last Post</th>
  </tr>
</thead>
{% if pinned_topics %}
<tbody>
{% for topic in pinned_topics %}
  <tr class="topic {% cycle odd,even %}">
    <td>
      Pinned: <a href="{{ topic.get_absolute_url }}">{{ topic.title|escape }}</a> {{ topic|topic_pagination:posts_per_page }}
      {% if topic.description %}<p class="description">{{ topic.description|escape }}</p>{% endif %}
    </td>
    <td><a href="{% url forum_user_profile topic.user_id %}">{{ topic.user_username|escape }}</a></td>
    <td>{{ topic.post_count }}</td>
    <td>{{ topic.view_count }}</td>
    <td>{{ topic.last_post_at|post_time:user }}<br><a href="{% url forum_redirect_to_last_post topic.id %}">Last Post</a> by <a href="{% url forum_user_profile topic.last_user_id %}">{{ topic.last_username|escape }}</a></td>
  </tr>{% endfor %}
</tbody>
<thead>
  <tr>
    <th colspan="5">Forum Topics</th>
  </tr>
</thead>
{% endif %}
<tbody>
{% for topic in topic_list %}
  <tr class="topic {% cycle odd,even %}">
    <td>
      <a href="{{ topic.get_absolute_url }}">{{ topic.title|escape }}</a> {{ topic|topic_pagination:posts_per_page }}
      {% if topic.description %}<p class="description">{{ topic.description|escape }}</p>{% endif %}
    </td>
    <td><a href="{% url forum_user_profile topic.user_id %}">{{ topic.user_username|escape }}</a></td>
    <td>{{ topic.post_count }}</td>
    <td>{{ topic.view_count }}</td>
    <td>{{ topic.last_post_at|post_time:user }}<br><a href="{% url forum_redirect_to_last_post topic.id %}">Last Post</a> by <a href="{% url forum_user_profile topic.last_user_id %}">{{ topic.last_username|escape }}</a></td>
  </tr>{% endfor %}
</tbody>
</table>
</div>
<div class="tools">
{% if is_paginated %}<div class="paginator">{% paginator "Topic" %}</div>{% endif %}
{% if user.is_authenticated %}
<div class="topic-actions">
  <a href="{% url forum_add_topic forum.id %}">New Topic</a>
</div>
{% endif %}
</div>
{% endblock %}